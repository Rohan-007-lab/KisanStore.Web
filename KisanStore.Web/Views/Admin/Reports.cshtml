@{
    ViewData["Title"] = "Reports & Analytics";
}

<div class="container-fluid my-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold">
                <i class="fas fa-chart-line text-primary"></i> Reports & Analytics
            </h2>
            <p class="text-muted mb-0">Overview of your store performance</p>
        </div>
        <div class="d-flex gap-2">
            <select class="form-select">
                <option>Last 7 Days</option>
                <option>Last 30 Days</option>
                <option>Last 3 Months</option>
                <option>This Year</option>
            </select>
            <button class="btn btn-primary">
                <i class="fas fa-download"></i> Export
            </button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row g-4 mb-4">
        <div class="col-md-3">
            <div class="stat-card revenue">
                <div class="stat-icon">
                    <i class="fas fa-rupee-sign"></i>
                </div>
                <div class="stat-content">
                    <h6>Total Revenue</h6>
                    <h3>₹2,45,680</h3>
                    <span class="badge-trend up">
                        <i class="fas fa-arrow-up"></i> 12.5%
                    </span>
                </div>
                <div class="mini-chart">
                    <svg viewBox="0 0 100 30">
                        <polyline points="0,20 20,15 40,22 60,10 80,18 100,8"
                                  fill="none" stroke="currentColor" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card orders">
                <div class="stat-icon">
                    <i class="fas fa-shopping-bag"></i>
                </div>
                <div class="stat-content">
                    <h6>Total Orders</h6>
                    <h3>1,248</h3>
                    <span class="badge-trend up">
                        <i class="fas fa-arrow-up"></i> 8.2%
                    </span>
                </div>
                <div class="mini-chart">
                    <svg viewBox="0 0 100 30">
                        <polyline points="0,25 20,18 40,20 60,12 80,15 100,10"
                                  fill="none" stroke="currentColor" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card customers">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-content">
                    <h6>Total Customers</h6>
                    <h3>856</h3>
                    <span class="badge-trend up">
                        <i class="fas fa-arrow-up"></i> 15.3%
                    </span>
                </div>
                <div class="mini-chart">
                    <svg viewBox="0 0 100 30">
                        <polyline points="0,22 20,20 40,15 60,18 80,12 100,8"
                                  fill="none" stroke="currentColor" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card products">
                <div class="stat-icon">
                    <i class="fas fa-box"></i>
                </div>
                <div class="stat-content">
                    <h6>Products Sold</h6>
                    <h3>3,542</h3>
                    <span class="badge-trend down">
                        <i class="fas fa-arrow-down"></i> 3.1%
                    </span>
                </div>
                <div class="mini-chart">
                    <svg viewBox="0 0 100 30">
                        <polyline points="0,18 20,15 40,20 60,12 80,16 100,14"
                                  fill="none" stroke="currentColor" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="row g-4 mb-4">
        <!-- Sales Chart -->
        <div class="col-lg-8">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-chart-area"></i> Sales Overview</h5>
                    <div class="chart-tabs">
                        <button class="active">Revenue</button>
                        <button>Orders</button>
                        <button>Customers</button>
                    </div>
                </div>
                <div class="chart-body">
                    <canvas id="salesChart" height="300"></canvas>
                </div>
            </div>
        </div>

        <!-- Top Products -->
        <div class="col-lg-4">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-fire"></i> Top Products</h5>
                </div>
                <div class="chart-body">
                    <div class="top-product-item">
                        <div class="product-rank">1</div>
                        <div class="product-info">
                            <h6>Chlorpyrifos 20% EC</h6>
                            <p>₹42,500</p>
                        </div>
                        <div class="progress-ring">
                            <span>85%</span>
                        </div>
                    </div>
                    <div class="top-product-item">
                        <div class="product-rank">2</div>
                        <div class="product-info">
                            <h6>NPK 19:19:19</h6>
                            <p>₹38,200</p>
                        </div>
                        <div class="progress-ring">
                            <span>75%</span>
                        </div>
                    </div>
                    <div class="top-product-item">
                        <div class="product-rank">3</div>
                        <div class="product-info">
                            <h6>Mancozeb 75% WP</h6>
                            <p>₹35,800</p>
                        </div>
                        <div class="progress-ring">
                            <span>68%</span>
                        </div>
                    </div>
                    <div class="top-product-item">
                        <div class="product-rank">4</div>
                        <div class="product-info">
                            <h6>Glyphosate 41% SL</h6>
                            <p>₹32,100</p>
                        </div>
                        <div class="progress-ring">
                            <span>62%</span>
                        </div>
                    </div>
                    <div class="top-product-item">
                        <div class="product-rank">5</div>
                        <div class="product-info">
                            <h6>Imidacloprid 17.8%</h6>
                            <p>₹28,900</p>
                        </div>
                        <div class="progress-ring">
                            <span>55%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Performance & Recent Orders -->
    <div class="row g-4 mb-4">
        <!-- Category Performance -->
        <div class="col-lg-6">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-chart-pie"></i> Category Performance</h5>
                </div>
                <div class="chart-body">
                    <canvas id="categoryChart" height="250"></canvas>
                </div>
                <div class="category-stats">
                    <div class="category-stat-item">
                        <div class="color-dot" style="background: #667eea;"></div>
                        <span>Insecticides</span>
                        <strong>35%</strong>
                    </div>
                    <div class="category-stat-item">
                        <div class="color-dot" style="background: #27ae60;"></div>
                        <span>Fungicides</span>
                        <strong>28%</strong>
                    </div>
                    <div class="category-stat-item">
                        <div class="color-dot" style="background: #f39c12;"></div>
                        <span>Herbicides</span>
                        <strong>22%</strong>
                    </div>
                    <div class="category-stat-item">
                        <div class="color-dot" style="background: #e74c3c;"></div>
                        <span>Fertilizers</span>
                        <strong>15%</strong>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="col-lg-6">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-bell"></i> Recent Activity</h5>
                </div>
                <div class="activity-list">
                    <div class="activity-item">
                        <div class="activity-icon new-order">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="activity-content">
                            <h6>New Order Received</h6>
                            <p>Order #ORD20241128001 - ₹2,450</p>
                            <small>2 minutes ago</small>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon new-customer">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="activity-content">
                            <h6>New Customer Registration</h6>
                            <p>Ramesh Kumar signed up</p>
                            <small>15 minutes ago</small>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon product-update">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="activity-content">
                            <h6>Product Stock Updated</h6>
                            <p>Chlorpyrifos 20% EC - 50 units added</p>
                            <small>1 hour ago</small>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon order-delivered">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="activity-content">
                            <h6>Order Delivered</h6>
                            <p>Order #ORD20241127045 delivered</p>
                            <small>3 hours ago</small>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon review">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="activity-content">
                            <h6>New Review Received</h6>
                            <p>5-star review on NPK Fertilizer</p>
                            <small>5 hours ago</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Customer Demographics & Sales by Region -->
    <div class="row g-4">
        <div class="col-lg-4">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-users"></i> Customer Demographics</h5>
                </div>
                <div class="demographics-list">
                    <div class="demo-item">
                        <span>New Customers</span>
                        <div class="progress-bar-custom">
                            <div class="progress-fill" style="width: 65%;"></div>
                        </div>
                        <strong>65%</strong>
                    </div>
                    <div class="demo-item">
                        <span>Returning Customers</span>
                        <div class="progress-bar-custom">
                            <div class="progress-fill" style="width: 35%;"></div>
                        </div>
                        <strong>35%</strong>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="chart-card">
                <div class="chart-header">
                    <h5><i class="fas fa-map-marked-alt"></i> Sales by Region</h5>
                </div>
                <div class="region-stats">
                    <div class="region-item">
                        <div class="region-info">
                            <h6>Maharashtra</h6>
                            <p>₹85,420</p>
                        </div>
                        <div class="region-progress">
                            <div class="progress-bar-custom">
                                <div class="progress-fill" style="width: 85%;"></div>
                            </div>
                            <span>85%</span>
                        </div>
                    </div>
                    <div class="region-item">
                        <div class="region-info">
                            <h6>Gujarat</h6>
                            <p>₹62,150</p>
                        </div>
                        <div class="region-progress">
                            <div class="progress-bar-custom">
                                <div class="progress-fill" style="width: 65%;"></div>
                            </div>
                            <span>65%</span>
                        </div>
                    </div>
                    <div class="region-item">
                        <div class="region-info">
                            <h6>Karnataka</h6>
                            <p>₹48,890</p>
                        </div>
                        <div class="region-progress">
                            <div class="progress-bar-custom">
                                <div class="progress-fill" style="width: 52%;"></div>
                            </div>
                            <span>52%</span>
                        </div>
                    </div>
                    <div class="region-item">
                        <div class="region-info">
                            <h6>Madhya Pradesh</h6>
                            <p>₹35,220</p>
                        </div>
                        <div class="region-progress">
                            <div class="progress-bar-custom">
                                <div class="progress-fill" style="width: 38%;"></div>
                            </div>
                            <span>38%</span>
                        </div>
                    </div>
                    <div class="region-item">
                        <div class="region-info">
                            <h6>Others</h6>
                            <p>₹14,000</p>
                        </div>
                        <div class="region-progress">
                            <div class="progress-bar-custom">
                                <div class="progress-fill" style="width: 15%;"></div>
                            </div>
                            <span>15%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .stat-card {
        background: white;
        border-radius: 16px;
        padding: 25px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            opacity: 0.1;
        }

        .stat-card.revenue::before {
            background: #667eea;
        }

        .stat-card.orders::before {
            background: #27ae60;
        }

        .stat-card.customers::before {
            background: #f39c12;
        }

        .stat-card.products::before {
            background: #e74c3c;
        }

    .stat-icon {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: white;
        margin-bottom: 15px;
    }

    .revenue .stat-icon {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .orders .stat-icon {
        background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
    }

    .customers .stat-icon {
        background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
    }

    .products .stat-icon {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    }

    .stat-content h6 {
        color: #7f8c8d;
        font-size: 0.9rem;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .stat-content h3 {
        font-size: 2rem;
        font-weight: 800;
        color: #2c3e50;
        margin-bottom: 10px;
    }

    .badge-trend {
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 700;
    }

        .badge-trend.up {
            background: #d4edda;
            color: #155724;
        }

        .badge-trend.down {
            background: #f8d7da;
            color: #721c24;
        }

    .mini-chart {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 120px;
        height: 40px;
        opacity: 0.3;
    }

        .mini-chart svg polyline {
            color: currentColor;
        }

    .revenue .mini-chart {
        color: #667eea;
    }

    .orders .mini-chart {
        color: #27ae60;
    }

    .customers .mini-chart {
        color: #f39c12;
    }

    .products .mini-chart {
        color: #e74c3c;
    }

    .chart-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        height: 100%;
    }

    .chart-header {
        padding: 25px;
        border-bottom: 2px solid #f0f0f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

        .chart-header h5 {
            font-weight: 700;
            color: #2c3e50;
            margin: 0;
        }

    .chart-tabs {
        display: flex;
        gap: 10px;
    }

        .chart-tabs button {
            padding: 8px 20px;
            border: none;
            background: #f0f0f0;
            border-radius: 20px;
            font-weight: 600;
            color: #7f8c8d;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .chart-tabs button.active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }

    .chart-body {
        padding: 25px;
    }

    .top-product-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        margin-bottom: 10px;
        background: #f8f9fa;
        border-radius: 12px;
        transition: all 0.3s ease;
    }

        .top-product-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

    .product-rank {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.1rem;
    }

    .product-info {
        flex: 1;
    }

        .product-info h6 {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 3px;
            font-size: 0.95rem;
        }

        .product-info p {
            color: #27ae60;
            font-weight: 700;
            margin: 0;
        }

    .progress-ring {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: conic-gradient(#667eea 0deg 306deg, #e9ecef 306deg 360deg);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

        .progress-ring::before {
            content: '';
            position: absolute;
            width: 35px;
            height: 35px;
            background: white;
            border-radius: 50%;
        }

        .progress-ring span {
            position: relative;
            z-index: 1;
            font-weight: 700;
            font-size: 0.8rem;
            color: #2c3e50;
        }

    .category-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        padding: 20px;
        border-top: 2px solid #f0f0f0;
    }

    .category-stat-item {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .color-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }

    .category-stat-item span {
        flex: 1;
        color: #7f8c8d;
        font-size: 0.9rem;
    }

    .category-stat-item strong {
        color: #2c3e50;
        font-size: 1rem;
    }

    .activity-list {
        padding: 15px;
        max-height: 400px;
        overflow-y: auto;
    }

    .activity-item {
        display: flex;
        gap: 15px;
        padding: 15px;
        margin-bottom: 10px;
        background: #f8f9fa;
        border-radius: 12px;
        transition: all 0.3s ease;
    }

        .activity-item:hover {
            background: #e9ecef;
        }

    .activity-icon {
        width: 45px;
        height: 45px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.2rem;
        flex-shrink: 0;
    }

        .activity-icon.new-order {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .activity-icon.new-customer {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .activity-icon.product-update {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .activity-icon.order-delivered {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .activity-icon.review {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        }

    .activity-content h6 {
        font-weight: 700;
        color: #2c3e50;
        font-size: 0.95rem;
        margin-bottom: 3px;
    }

    .activity-content p {
        color: #7f8c8d;
        margin-bottom: 3px;
        font-size: 0.85rem;
    }

    .activity-content small {
        color: #95a5a6;
        font-size: 0.8rem;
    }

    .demographics-list,
    .region-stats {
        padding: 20px;
    }

    .demo-item,
    .region-item {
        margin-bottom: 20px;
    }

    .demo-item {
        display: grid;
        grid-template-columns: 120px 1fr 50px;
        align-items: center;
        gap: 15px;
    }

    .region-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 12px;
        margin-bottom: 15px;
    }

    .region-info h6 {
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 3px;
    }

    .region-info p {
        color: #27ae60;
        font-weight: 700;
        margin: 0;
    }

    .region-progress {
        display: flex;
        align-items: center;
        gap: 15px;
        flex: 1;
        max-width: 300px;
    }

    .progress-bar-custom {
        flex: 1;
        height: 8px;
        background: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        transition: width 0.5s ease;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Sales Chart
    const salesCtx = document.getElementById('salesChart').getContext('2d');
    new Chart(salesCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
                label: 'Revenue',
                data: [12000, 19000, 15000, 25000, 22000, 30000, 28000, 32000, 29000, 35000, 38000, 42000],
                borderColor: '#667eea',
                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }
            }
        }
    });

    // Category Chart
    const categoryCtx = document.getElementById('categoryChart').getContext('2d');
    new Chart(categoryCtx, {
        type: 'doughnut',
        data: {
            labels: ['Insecticides', 'Fungicides', 'Herbicides', 'Fertilizers'],
            datasets: [{
                data: [35, 28, 22, 15],
                backgroundColor: ['#667eea', '#27ae60', '#f39c12', '#e74c3c']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }
            }
        }
    });
</script>